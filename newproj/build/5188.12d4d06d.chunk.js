"use strict";(self.webpackChunknewproj=self.webpackChunknewproj||[]).push([[5188],{35099:(S,O,n)=>{n.d(O,{M:()=>R});var m=n(92132),g=n(94061),L=n(92333),M=n.n(L);function F(C,b,A){if(!C||!b||!A)return{display:"none"};const{x:p,y:P}=A;return{transform:`translate(${p}px, ${P}px)`}}const R=({renderItem:C})=>{const{itemType:b,isDragging:A,item:p,initialOffset:P,currentOffset:Y,mouseOffset:U}=(0,L.useDragLayer)(k=>({item:k.getItem(),itemType:k.getItemType(),initialOffset:k.getInitialSourceClientOffset(),currentOffset:k.getSourceClientOffset(),isDragging:k.isDragging(),mouseOffset:k.getClientOffset()}));return A?(0,m.jsx)(g.a,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%",children:(0,m.jsx)(g.a,{style:F(P,Y,U),children:C({type:b,item:p})})}):null}},96953:(S,O,n)=>{var m=n(21272);const g=(0,m.createContext)();var L=null},99142:(S,O,n)=>{n.d(O,{PO:()=>F,gY:()=>R.g,Rr:()=>oe,td:()=>J,mT:()=>ne,NQ:()=>ce,Jz:()=>a});var m=n(21272),g=n(82437),L=n(16391);const F=()=>{const e=(0,g.d4)(L.A),t=(0,m.useCallback)(s=>e?.components?.[s]??{},[e]);return{...e,getComponentLayout:t}};var R=n(46057),C=n(80403),b=n(41629),A=n(96046),p=n(88761);const P={error:null,isLoading:!0,layout:{},layouts:{}},U=(e,t)=>(0,p.Ay)(e,s=>{switch(t.type){case"GET_DATA":{s.isLoading=!0,s.error=null,s.layout={};break}case"GET_DATA_SUCCEEDED":{const o=t.data.contentType.uid;s.layout=t.data,s.layouts[o]=t.data,s.isLoading=!1;break}case"GET_DATA_ERROR":{s.isLoading=!1,s.error=t.error;break}case"SET_LAYOUT_FROM_STATE":{s.error=null,s.layout=e.layouts[t.uid];break}case"UPDATE_LAYOUT":{const o=e.layout;s.layout={...o,contentType:{uid:o.contentType.uid,...t.newLayout.contentType}},s.layouts[o.contentType.uid]={...o,contentType:{uid:o.contentType.uid,...t.newLayout.contentType}};break}default:return s}});var k=n(51187),x=n.n(k),H=n(2600),v=n.n(H),re=n(48940),N=n.n(re),_=n(98342);const w=(e,t)=>t.find(s=>s.uid===e),ie=(e,t)=>{const s=q(e,t),o=W(s.contentType,t),u=ee(s.contentType,s.components);return N()(s,["contentType","layouts","edit"],o),N()(s,["contentType","layouts","list"],u),Object.keys(s.components).forEach(c=>{const f=W(s.components[c],t);N()(s,["components",c,"layouts","edit"],f)}),s},q=(e,t)=>{const s=(0,_.wX)(x()(e),t,"contentType"),{components:o,contentType:u}=s,c=f=>Object.keys(f.metadatas).reduce((D,T)=>{const j=v()(f,["attributes",T],{});let I=f.metadatas[T];if(j.type==="relation"){const ye=w(j.targetModel,t),K=I.edit.mainField,X={name:K,schema:v()(ye,["attributes",K])};I={list:{...I.list,mainField:X},edit:{...I.edit,mainField:X}}}return D[T]=I,D},{});return N()(s,["contentType","metadatas"],c(u)),Object.keys(o).forEach(f=>{const D=o[f],T=c(D);N()(s,["components",f,"metadatas"],T)}),s},W=(e,t)=>e.layouts.edit.reduce((s,o)=>{const u=o.map(c=>{const f=v()(e,["attributes",c.name],{}),D={...c,fieldSchema:f,metadatas:v()(e,["metadatas",c.name,"edit"],{})};if(f.type==="relation"){const j=w(f.targetModel,t).pluginOptions||{};N()(D,"targetModelPluginOptions",j),N()(D,"queryInfos",{shouldDisplayRelationLink:z(e,c.name,t)})}return D});return s.push(u),s},[]),ee=(e,t)=>e.layouts.list.reduce((o,u)=>{const c=v()(e,["attributes",u],{}),f=v()(e,["metadatas",u,"list"],{}),D=c.type;if(D==="relation")return o.push({key:`__${u}_key__`,name:u,fieldSchema:c,metadatas:f}),o;if(D==="component"){const T=t[c.component],j=T.settings.mainField,I=T.attributes[j];return o.push({key:`__${u}_key__`,name:u,fieldSchema:c,metadatas:{...f,mainField:{...I,name:j}}}),o}return o.push({key:`__${u}_key__`,name:u,fieldSchema:c,metadatas:f}),o},[]),z=(e,t,s)=>{const o=v()(e,["attributes",t,"targetModel"],"");return B(s).includes(o)},B=e=>e.filter(t=>t.isDisplayed).map(({uid:t})=>t),$=ie,oe=e=>{const[{error:t,isLoading:s,layout:o,layouts:u},c]=(0,m.useReducer)(U,P),f=(0,m.useMemo)(A.O8,[]),{schemas:D}=(0,g.d4)(K=>f(K),g.bN),T=(0,m.useRef)(!0),{get:j}=(0,C.ry)(),I=(0,m.useCallback)(async(K,X)=>{if(u[K]){c({type:"SET_LAYOUT_FROM_STATE",uid:K});return}c({type:"GET_DATA"});try{const{data:{data:se}}=await j(`/content-manager/content-types/${K}/configuration`,{cancelToken:X.token});c({type:"GET_DATA_SUCCEEDED",data:$(se,D)})}catch(se){if(b.A.isCancel(se))return;T.current&&console.error(se),T.current&&c({type:"GET_DATA_ERROR",error:se})}},[u,D,j]);(0,m.useEffect)(()=>()=>{T.current=!1},[]),(0,m.useEffect)(()=>{const X=b.A.CancelToken.source();return I(e,X),()=>{X.cancel("Operation canceled by the user.")}},[e,I]);const ye=(0,m.useCallback)(K=>{c({type:"UPDATE_LAYOUT",newLayout:$(K,D)})},[D]);return{error:t,isLoading:s,layout:o,updateLayout:ye}},ge=e=>e["content-manager_app"].collectionTypeLinks;var ue=n(57505),h=n.n(ue),V=n(5409);const ae=(e,t)=>Object.keys(e).reduce((s,o)=>{const u=e[o],c=v()(t,[o],u);return h()(u)?{...s,[o]:ae(u,c)}:(s[o]=c,s)},{}),le=(e,t,s)=>{const o=e.find(({to:I})=>I.includes(t));if(!o)return"/";const{to:u,search:c}=o,f=(0,V.parse)(c),D=(0,V.parse)(s.substring(1)),T=ae(f,D);return`${u}?${(0,V.stringify)(T,{encode:!1})}`},J=e=>{const[{rawQuery:t}]=(0,C.sq)(),s=(0,g.d4)(ge);return le(s,e,t)};var Te=n(74814),Z=n(17703);const ne=()=>{const{search:e}=(0,Z.zy)(),t=e?(0,V.parse)(e.substring(1)):{};return t.plugins?(0,V.stringify)({plugins:t.plugins},{encode:!1}):""},ce=e=>{const t=(0,m.useRef)();return(0,m.useEffect)(()=>{t.current=e},[e]),t.current};var G=n(53626);const de=(e,t,s)=>({type:G.w,permissions:e,__meta__:{plugins:t,containerName:s}}),me=()=>({type:G.p}),fe=e=>e["content-manager_rbacManager"].permissions,r=e=>e.rbacProvider.collectionTypesRelatedPermissions,a=(e,t,s="listView")=>{const o=(0,g.wA)(),u=(0,g.d4)(r),c=(0,g.d4)(fe),f=u[t];(0,m.useEffect)(()=>f?(o(de(f,e?e.plugins:null,s)),()=>{o(me())}):()=>{},[f,o,e,s]);const D=c?.some(T=>T.subject!==t)??!0;return{isValid:c&&!D,permissions:c}};var i=n(96953);const d=()=>useContext(WysiwygContext),y=null},46057:(S,O,n)=>{n.d(O,{g:()=>F});var m=n(21272),g=n(92333),L=n.n(g),M=n(74814);const F=(R,{type:C="STRAPI_DND",index:b,item:A={},onStart:p,onEnd:P,onGrabItem:Y,onDropItem:U,onCancel:k,onMoveItem:x,dropSensitivity:H="regular"})=>{const v=(0,m.useRef)(null),[{handlerId:re},N]=(0,g.useDrop)({accept:C,collect(W){return{handlerId:W.getHandlerId()}},hover(W,ee){if(!v.current)return;const z=W.index,B=b;if(z!==B){if(H==="regular"){const $=v.current.getBoundingClientRect(),te=($.bottom-$.top)/2,Q=ee.getClientOffset().y-$.top;if(z<B&&Q<te||z>B&&Q>te)return}x(B,z),W.index=B}}}),[{isDragging:_},w,ie]=(0,g.useDrag)({type:C,item(){p&&p();const{width:W}=v.current?.getBoundingClientRect()??{};return{index:b,width:W,...A}},end(){P&&P()},canDrag:R,isDragging:A.id?W=>A.id===W.getItem().id:void 0,collect:W=>({isDragging:W.isDragging()})}),q=(0,M.$)(R,b,{onGrabItem:Y,onDropItem:U,onCancel:k,onMoveItem:x});return[{handlerId:re,isDragging:_,handleKeyDown:q},v,N,w,ie]}},74814:(S,O,n)=>{n.d(O,{$:()=>g});var m=n(21272);const g=(L,M,{onCancel:F,onDropItem:R,onGrabItem:C,onMoveItem:b})=>{const[A,p]=(0,m.useState)(!1),P=x=>{A&&(x==="UP"?b(M-1,M):x==="DOWN"&&b(M+1,M))},Y=()=>{A?(R&&R(M),p(!1)):(C&&C(M),p(!0))},U=()=>{A&&(p(!1),F&&F(M))};return x=>{if(L&&!(x.key==="Tab"&&!A))switch(x.preventDefault(),x.key){case" ":case"Enter":Y();break;case"Escape":U();break;case"ArrowDown":case"ArrowRight":P("DOWN");break;case"ArrowUp":case"ArrowLeft":P("UP");break;default:}}}},96046:(S,O,n)=>{n.d(O,{LJ:()=>R,O8:()=>C,Xc:()=>b,_I:()=>L});var m=n(26924),g=n(77828);const L=()=>p=>p["content-manager_app"]||g.u,M=()=>createSelector(L(),p=>p),F=()=>createSelector(L(),p=>p.models),R=()=>(0,m.Mz)(L(),p=>({collectionTypeLinks:p.collectionTypeLinks,singleTypeLinks:p.singleTypeLinks})),C=()=>(0,m.Mz)(L(),({components:p,models:P})=>({schemas:[...p,...P]})),b=(0,m.Mz)(L(),p=>p.fieldSizes);var A=null},16391:(S,O,n)=>{n.d(O,{A:()=>g});const g=L=>L["content-manager_editViewLayoutManager"].currentLayout},27009:(S,O,n)=>{n.d(O,{A:()=>m});const m={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},58900:(S,O,n)=>{n.d(O,{M:()=>m});const m=({firstname:g,lastname:L,username:M,email:F},R)=>M||(g?R({id:"global.fullname",defaultMessage:"{firstname} {lastname}"},{firstname:g,lastname:L}).trim():F)},7706:(S,O,n)=>{n.d(O,{A:()=>g});const g=L=>`content-manager.${L}`},98342:(S,O,n)=>{n.d(O,{ll:()=>B.A,Sq:()=>M,oE:()=>R,tE:()=>b,IL:()=>Y,Mq:()=>me,vW:()=>H,BO:()=>N,Mn:()=>fe.M,MO:()=>q,CU:()=>ee,gT:()=>z.A,wX:()=>ue,hi:()=>ae});var m=n(51187),g=n.n(m);const M=(r,l,a)=>{if(Array.isArray(r)&&l>=0&&a>=0&&l<=r.length-1&&a<=r.length-1){const i=g()(r),d=i.splice(l,1);return i.splice(a,0,d[0]),i}return r},R=r=>{const{type:l}=r;return l==="relation"?!(r?.relationType??"").toLowerCase().includes("morph"):!["json","dynamiczone","richtext","password","blocks"].includes(l)&&!!l},C=(r,l)=>{typeof r=="function"?r(l):r!=null&&(r.current=l)},b=(...r)=>l=>r.forEach(a=>C(a,l));var A=n(2600),p=n.n(A);const P=(r,l)=>Object.keys(r).reduce((a,i)=>{const d=p()(r,[i],{}),{default:y,component:e,type:t,required:s,min:o,repeatable:u}=d;if(y!==void 0&&(a[i]=y),t==="component"){const c=l?.[e]?.attributes??{},f=P(c,l);if(s===!0&&(a[i]=u===!0?[]:f),o&&u===!0&&s){a[i]=[];for(let D=0;D<o;D+=1)a[i].push(f)}}return t==="dynamiczone"&&s===!0&&(a[i]=[]),a},{}),Y=P;var U=n(35223),k=n.n(U);const H=({layouts:r,metadatas:l,...a})=>{const i=r.list.map(e=>e.name?e.name:e),d=Object.keys(l).reduce((e,t)=>{const s=p()(l,[t],{});let o=s.edit;return o.mainField&&(o={...o,mainField:s.edit.mainField.name}),{...e,[t]:{edit:o,list:k()(s.list,["mainField"])}}},{}),y=r.edit.map(e=>e.map(({name:t,size:s})=>({name:t,size:s})));return{...a,layouts:{edit:y,list:i},metadatas:d}},v=(r,l)=>r.map(a=>({...a,subject:l})),N=r=>{const l={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(l).reduce((a,i)=>(a[i]=v(l[i],r),a),{})};var _=n(54257),w=n.n(_);const q=r=>r.split(".").filter(l=>w()(parseInt(l,10))),ee=r=>{if(r.length===0)return-1;const l=Math.max.apply(Math,r.map(a=>a.__temp_key__??0));return Number.isNaN(l)?-1:l};var z=n(7706),B=n(27009),$=n(59080),te=n.n($),oe=n(48940),Q=n.n(oe);const ue=(r,l,a)=>{const i=t=>l.find(s=>s.uid===t),d=Object.assign({},r),y=r[a].uid,e=i(y);return Q()(d,[a],te()({},e,r[a])),Object.keys(r.components).forEach(t=>{const s=i(t);Q()(d,["components",t],{...r.components[t],...s})}),d};var h=n(80403);const ae=(r,l,a)=>{const i=(d,y)=>Object.keys(d).reduce((e,t)=>{const s=(0,h.Pw)(y,t),o=p()(d,t),u=(0,h.uq)(y,[t,"component"]),c=(0,h.uq)(y,[t,"repeatable"]);return s==="dynamiczone"?(e[t]=o.map(f=>i(f,a[f.__component])),e):s==="component"?(c?e[t]=o&&o.map(f=>i(f,a[u])):e[t]=o&&i(o,a[u]),e):(s!=="password"&&(e[t]=o),e)},{});return i(r,l)};var pe=n(84624),le=n.n(pe),he=n(77965),J=n.n(he),Te=n(71210),Z=n.n(Te),E=n(12083),ne=n(81748);E.Zg(E.gl,"defined",function(){return this.test("defined",h.iW.required,r=>r!==void 0)}),E.Zg(E.YO,"notEmptyMin",function(r){return this.test("notEmptyMin",h.iW.min,l=>J()(l)?!0:l.length>=r)}),E.Zg(E.Yj,"isInferior",function(r,l){return this.test("isInferior",r,function(a){return!a||Number.isNaN(Z()(a))?!0:Z()(l)>=Z()(a)})}),E.Zg(E.Yj,"isSuperior",function(r,l){return this.test("isSuperior",r,function(a){return!a||Number.isNaN(Z()(a))?!0:Z()(a)>=Z()(l)})});const ce=r=>p()(r,["attributes"],{}),G=(r,{components:l},a={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1,isJSONTestDisabled:!1})=>{const i=ce(r);return E.Ik().shape(Object.keys(i).reduce((d,y)=>{const e=i[y];if(e.type!=="relation"&&e.type!=="component"&&e.type!=="dynamiczone"){const t=de(e.type,e,a);d[y]=t}if(e.type==="relation"&&(d[y]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(e.relationType)?E.Ik().nullable():E.YO().nullable()),e.type==="component"){const t=G(l[e.component],{components:l},{...a,isFromComponent:!0});if(e.repeatable===!0){const{min:o,max:u,required:c}=e;let f=E.RZ(D=>{let T=E.YO().of(t);return o?c?T=T.min(o,h.iW.min):c!==!0&&J()(D)?T=T.nullable():T=T.min(o,h.iW.min):c&&!a.isDraft&&(T=T.min(1,h.iW.required)),u&&(T=T.max(u,h.iW.max)),T});return d[y]=f,d}const s=E.RZ(o=>o!==void 0?e.required===!0&&!a.isDraft?t.defined():t.nullable():e.required===!0?E.Ik().defined():E.Ik().nullable());return d[y]=s,d}if(e.type==="dynamiczone"){let t=E.YO().of(E.RZ(({__component:u})=>G(l[u],{components:l},{...a,isFromComponent:!0})));const{max:s,min:o}=e;o?e.required?t=t.test("min",h.iW.min,u=>a.isCreatingEntry?u&&u.length>=o:u===void 0?!0:u!==null&&u.length>=o).test("required",h.iW.required,u=>a.isCreatingEntry?u!==null||u!==void 0:u===void 0?!0:u!==null):t=t.notEmptyMin(o):e.required&&!a.isDraft&&(t=t.test("required",h.iW.required,u=>a.isCreatingEntry?u!==null||u!==void 0:u===void 0?!0:u!==null)),s&&(t=t.max(s,h.iW.max)),d[y]=t}return d},{}))},de=(r,l,a)=>{let i=E.gl();return["string","uid","text","richtext","email","password","enumeration"].includes(r)&&(i=E.Yj()),r==="blocks"&&(i=E.gl().test("isJSON",h.iW.json,d=>a.isJSONTestDisabled||a.isDraft?!0:!(d&&!Array.isArray(d)))),r==="json"&&(i=E.gl(h.iW.json).test("isJSON",h.iW.json,d=>{if(a.isJSONTestDisabled||!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",h.iW.required,d=>!(l.required&&(!d||!d.length)))),r==="email"&&(i=i.email(h.iW.email)),["number","integer","float","decimal"].includes(r)&&(i=E.ai().transform(d=>w()(d)?void 0:d).typeError()),r==="biginteger"&&(i=E.Yj().matches(/^-?\d*$/)),["date","datetime"].includes(r)&&(i=E.p6()),Object.keys(l).forEach(d=>{const y=l[d];if(y||!le()(y)&&Number.isInteger(Math.floor(y))||y===0)switch(d){case"required":{a.isDraft||(r==="password"&&a.isCreatingEntry&&(i=i.required(h.iW.required)),r!=="password"&&(a.isCreatingEntry?i=i.required(h.iW.required):i=i.test("required",h.iW.required,e=>e===void 0&&!a.isFromComponent?!0:(0,ne.A)(r)?e===0?!0:!!e:r==="boolean"?e!=null:r==="date"||r==="datetime"?typeof e=="string"?!J()(e):!J()(e?.toString()):!J()(e))));break}case"max":{r==="biginteger"?i=i.isInferior(h.iW.max,y):i=i.max(y,h.iW.max);break}case"maxLength":i=i.max(y,h.iW.maxLength);break;case"min":{r==="biginteger"?i=i.isSuperior(h.iW.min,y):i=i.min(y,h.iW.min);break}case"minLength":{a.isDraft||(i=i.min(y,h.iW.minLength));break}case"regex":i=i.matches(new RegExp(y),{message:h.iW.regex,excludeEmptyString:!l.required});break;case"lowercase":["text","textarea","email","string"].includes(r)&&(i=i.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(r)&&(i=i.strict().uppercase());break;case"positive":(0,ne.A)(r)&&(i=i.positive());break;case"negative":(0,ne.A)(r)&&(i=i.negative());break;default:i=i.nullable()}}),i},me=G;var fe=n(58900)},81748:(S,O,n)=>{n.d(O,{A:()=>m});function m(g){return["integer","biginteger","decimal","float","number"].includes(g)}}}]);
