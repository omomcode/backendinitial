"use strict";(self.webpackChunknewproj=self.webpackChunknewproj||[]).push([[1177],{54729:(G,p,t)=>{t.d(p,{g:()=>u});var e=t(21272),n=t(80403),i=t(54894),c=t(74930);const u=(j={},I={})=>{const{id:M="",...y}=j,{get:o}=(0,n.ry)(),{locale:W}=(0,i.A)(),L=(0,n.QM)(W,{sensitivity:"base"}),{data:D,error:d,isError:C,isLoading:V,refetch:Q}=(0,c.useQuery)(["roles",M,y],async()=>{const{data:T}=await o(`/admin/roles/${M??""}`,{params:y});return T},I);return{roles:e.useMemo(()=>{let T=[];return D&&(Array.isArray(D.data)?T=D.data:T=[D.data]),[...T].sort((z,K)=>L.compare(z.name,K.name))},[D,L]),error:d,isError:C,isLoading:V,refetch:Q}}},36156:(G,p,t)=>{t.r(p),t.d(p,{default:()=>ue});var e=t(21272),n=t(80403),i=t(82437),c=t(71526),u=t(38413),j=t(55356),I=t(85963),M=t(74773),y=t(4198),o=t(35513),W=t(40216),L=t(26127),D=t(90361),d=t(33363),C=t(30893),V=t(98765),Q=t(25641),Z=t(90625),T=t(41909),z=t(50612),K=t(5194),H=t(54894),q=t(17703),_=t(54729);const ee=()=>"todo empty role";var te=t(83997),ne=t(94061),le=t(88353),se=t(33544),v=t.n(se);const X=({id:s,name:m,description:a,usersCount:O,icons:r,rowIndex:U,canUpdate:E})=>{const{formatMessage:A}=(0,H.A)(),[,P]=r,g=A({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:O});return e.createElement(D.Tr,{"aria-rowindex":U,key:s,...E?(0,n.qM)({fn:P.onClick}):{}},e.createElement(d.Td,{maxWidth:(0,n.a8)(130)},e.createElement(C.o,{ellipsis:!0,textColor:"neutral800"},m)),e.createElement(d.Td,{maxWidth:(0,n.a8)(250)},e.createElement(C.o,{ellipsis:!0,textColor:"neutral800"},a)),e.createElement(d.Td,null,e.createElement(C.o,{textColor:"neutral800"},g)),e.createElement(d.Td,null,e.createElement(te.s,{justifyContent:"flex-end",...n.dG},r.map((h,x)=>h?e.createElement(ne.a,{key:h.label,paddingLeft:x===0?0:1},e.createElement(le.K,{onClick:h.onClick,label:h.label,noBorder:!0,icon:h.icon})):null))))};X.propTypes={id:v().number.isRequired,name:v().string.isRequired,description:v().string.isRequired,usersCount:v().number.isRequired,icons:v().array.isRequired,rowIndex:v().number.isRequired,canUpdate:v().bool},X.defaultProps={canUpdate:!1};const ae=X;var oe=t(88761);const re={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},ie=(s,m)=>(0,oe.Ay)(s,a=>{switch(m.type){case"ON_REMOVE_ROLES":{a.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{a.shouldRefetchData=!0,a.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{a.shouldRefetchData=!1,a.roleToDelete=null,a.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{a.roleToDelete=m.id;break}default:return a}}),de=({canCreate:s,canDelete:m,canUpdate:a,refetchRoles:O})=>{const{formatMessage:r}=(0,H.A)(),{formatAPIError:U}=(0,n.wq)(),E=(0,n.hN)(),[A,P]=(0,e.useState)(!1),{push:g}=(0,q.W6)(),[{selectedRoles:h,showModalConfirmButtonLoading:x,roleToDelete:w},b]=(0,e.useReducer)(ie,re),{post:J}=(0,n.GD)(),Y=async()=>{try{b({type:"ON_REMOVE_ROLES"}),await J("/admin/roles/batch-delete",{ids:[w]}),await O(),b({type:"RESET_DATA_TO_DELETE"})}catch(l){E({type:"warning",message:U(l)})}B()},$=(0,e.useCallback)(l=>{g(`/settings/roles/duplicate/${l}`)},[g]),S=()=>g("/settings/roles/new"),N=(0,e.useCallback)(l=>{b({type:"SET_ROLE_TO_DELETE",id:l}),B()},[]),B=()=>P(l=>!l),f=(0,e.useCallback)(l=>{g(`/settings/roles/${l}`)},[g]),F=(0,e.useCallback)((l,R)=>{l.preventDefault(),l.stopPropagation(),R.usersCount?E({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):N(R.id)},[E,N]),k=(0,e.useCallback)((l,R)=>{l.preventDefault(),l.stopPropagation(),$(R.id)},[$]),me=(0,e.useCallback)(l=>[...s?[{onClick:R=>k(R,l),label:r({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Z.A,null)}]:[],...a?[{onClick:()=>f(l.id),label:r({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(T.A,null)}]:[],...m?[{onClick:R=>F(R,l),label:r({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(z.A,null)}]:[]],[r,F,k,f,s,a,m]);return{handleNewRoleClick:S,getIcons:me,selectedRoles:h,isWarningDeleteAllOpened:A,showModalConfirmButtonLoading:x,handleToggleModal:B,handleDeleteData:Y}},ce=()=>{const{formatMessage:s}=(0,H.A)();(0,n.L4)();const m=(0,i.d4)(c.G),[{query:a}]=(0,n.sq)(),{isLoading:O,allowedActions:{canCreate:r,canDelete:U,canRead:E,canUpdate:A}}=(0,n.ec)(m.settings.roles),{roles:P,isLoading:g,refetch:h}=(0,_.g)({filters:a?._q?{name:{$containsi:a._q}}:void 0},{cacheTime:0,enabled:!O&&E}),{handleNewRoleClick:x,getIcons:w,isWarningDeleteAllOpened:b,showModalConfirmButtonLoading:J,handleToggleModal:Y,handleDeleteData:$}=de({refetchRoles:h,canCreate:r,canDelete:U,canUpdate:A}),S=P.length+1,N=6;if(O)return e.createElement(u.g,null,e.createElement(n.Bl,null));const B=s({id:"global.roles",defaultMessage:"roles"});return e.createElement(u.g,null,e.createElement(n.x7,{name:"Roles"}),e.createElement(j.Q,{primaryAction:r?e.createElement(I.$,{onClick:x,startIcon:e.createElement(K.A,null),size:"S"},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:B,subtitle:s({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),E&&e.createElement(M.B,{startActions:e.createElement(n.q7,{label:s({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:B})})}),E&&e.createElement(y.s,null,e.createElement(o.X,{colCount:N,rowCount:S,footer:r?e.createElement(W.S,{onClick:x,icon:e.createElement(K.A,null)},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(L.d,null,e.createElement(D.Tr,{"aria-rowindex":1},e.createElement(d.Th,null,e.createElement(C.o,{variant:"sigma",textColor:"neutral600"},s({id:"global.name",defaultMessage:"Name"}))),e.createElement(d.Th,null,e.createElement(C.o,{variant:"sigma",textColor:"neutral600"},s({id:"global.description",defaultMessage:"Description"}))),e.createElement(d.Th,null,e.createElement(C.o,{variant:"sigma",textColor:"neutral600"},s({id:"global.users",defaultMessage:"Users"}))),e.createElement(d.Th,null,e.createElement(V.s,null,s({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Q.N,null,P?.map((f,F)=>e.createElement(ae,{key:f.id,id:f.id,name:f.name,description:f.description,usersCount:f.usersCount,icons:w(f),rowIndex:F+2,canUpdate:A})))),!S&&!g&&e.createElement(ee,null)),e.createElement(n.TM,{isOpen:b,onConfirm:$,isConfirmButtonLoading:J,onToggleDialog:Y}))},ue=()=>{const s=(0,i.d4)(c.G);return e.createElement(n.kz,{permissions:s.settings.roles.main},e.createElement(ce,null))}},74773:(G,p,t)=>{t.d(p,{B:()=>i});var e=t(92132),n=t(83997);const i=({startActions:c,endActions:u})=>!c&&!u?null:(0,e.jsxs)(n.s,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(n.s,{gap:2,wrap:"wrap",children:c}),(0,e.jsx)(n.s,{gap:2,shrink:0,wrap:"wrap",children:u})]})},40216:(G,p,t)=>{t.d(p,{S:()=>y});var e=t(92132),n=t(79793),i=t(94061),c=t(48653),u=t(83997),j=t(30893);const I=(0,n.Ay)(i.a)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:o})=>o.colors.primary600};
  }
`,M=(0,n.Ay)(i.a)`
  border-radius: 0 0 ${({theme:o})=>o.borderRadius} ${({theme:o})=>o.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,y=({children:o,icon:W,...L})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(c.c,{}),(0,e.jsx)(M,{as:"button",background:"primary100",padding:5,...L,children:(0,e.jsxs)(u.s,{children:[(0,e.jsx)(I,{"aria-hidden":!0,background:"primary200",children:W}),(0,e.jsx)(i.a,{paddingLeft:3,children:(0,e.jsx)(j.o,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:o})})]})})]})}}]);
