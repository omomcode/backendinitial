"use strict";(self.webpackChunknewproj=self.webpackChunknewproj||[]).push([[7003],{40025:(k,I,a)=>{a.r(I),a.d(I,{default:()=>me});var e=a(21272),c=a(11273),M=a(38413),N=a(55356),b=a(4198),$=a(85963),h=a(94061),y=a(83997),l=a(80403),P=a(54514),S=a(61535),A=a(14718),j=a(54894),Y=a(74930),q=a(60725),_=a(48004),G=a(40609),K=a(7537),ee=a(88875),U=a(30893),W=a(90151),u=a(68074),R=a(83925),F=a(93337),ae=a(33544),t=a.n(ae),Z=a(79793);const V=(0,Z.Ay)(K.k)`
  ::-ms-reveal {
    display: none;
  }
`,B=(0,Z.Ay)(ee.T)`
  svg {
    height: ${(0,l.a8)(16)};
    width: ${(0,l.a8)(16)};
    path {
      fill: ${({theme:n})=>n.colors.neutral600};
    }
  }
`,H=({errors:n,onChange:d,values:m})=>{const{formatMessage:i}=(0,j.A)(),[s,T]=(0,e.useState)(!1),[r,x]=(0,e.useState)(!1),[C,z]=(0,e.useState)(!1);return e.createElement(h.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(y.s,{direction:"column",alignItems:"stretch",gap:4},e.createElement(U.o,{variant:"delta",as:"h2"},i({id:"global.change-password",defaultMessage:"Change password"})),e.createElement(W.x,{gap:5},e.createElement(u.E,{s:12,col:6},e.createElement(K.k,{error:n.currentPassword?i({id:n.currentPassword,defaultMessage:n.currentPassword}):"",onChange:d,value:m.currentPassword,label:i({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:s?"text":"password",endAction:e.createElement(B,{onClick:w=>{w.stopPropagation(),T(E=>!E)},label:i(s?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},s?e.createElement(R.A,null):e.createElement(F.A,null))}))),e.createElement(W.x,{gap:5},e.createElement(u.E,{s:12,col:6},e.createElement(V,{error:n.password?i({id:n.password,defaultMessage:n.password}):"",onChange:d,value:m.password,label:i({id:"global.password",defaultMessage:"Password"}),name:"password",type:r?"text":"password",autoComplete:"new-password",endAction:e.createElement(B,{onClick:w=>{w.stopPropagation(),x(E=>!E)},label:i(r?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},r?e.createElement(R.A,null):e.createElement(F.A,null))})),e.createElement(u.E,{s:12,col:6},e.createElement(V,{error:n.confirmPassword?i({id:n.confirmPassword,defaultMessage:n.confirmPassword}):"",onChange:d,value:m.confirmPassword,label:i({id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"}),name:"confirmPassword",type:C?"text":"password",autoComplete:"new-password",endAction:e.createElement(B,{onClick:w=>{w.stopPropagation(),z(E=>!E)},label:i(C?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},C?e.createElement(R.A,null):e.createElement(F.A,null))})))))};H.propTypes={errors:t().shape({currentPassword:t().string,password:t().string,confirmPassword:t().string}),onChange:t().func,values:t().shape({currentPassword:t().string,password:t().string,confirmPassword:t().string})},H.defaultProps={errors:{},onChange(){},values:{currentPassword:"",password:"",confirmPassword:""}};const te=H;var L=a(48323),se=a(39404),ne=a.n(se);const Q=({onChange:n,values:d,localeNames:m,allApplicationThemes:i})=>{const{formatMessage:s}=(0,j.A)(),T=Object.keys(i).filter(r=>i[r]);return e.createElement(h.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(y.s,{direction:"column",alignItems:"stretch",gap:4},e.createElement(y.s,{direction:"column",alignItems:"stretch",gap:1},e.createElement(U.o,{variant:"delta",as:"h2"},s({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})),e.createElement(U.o,null,s({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:e.createElement(h.a,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales"},s({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"}))}))),e.createElement(W.x,{gap:5},e.createElement(u.E,{s:12,col:6},e.createElement(L.Z,{label:s({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:s({id:"global.select",defaultMessage:"Select"}),hint:s({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{n({target:{name:"preferedLanguage",value:null}})},clearLabel:s({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:d.preferedLanguage,onChange:r=>{n({target:{name:"preferedLanguage",value:r}})}},Object.entries(m).map(([r,x])=>e.createElement(L.eY,{value:r,key:r},x)))),e.createElement(u.E,{s:12,col:6},e.createElement(L.Z,{label:s({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:s({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:s({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:d.currentTheme,onChange:r=>{n({target:{name:"currentTheme",value:r}})}},e.createElement(L.eY,{value:"system"},s({id:"Settings.profile.form.section.experience.mode.option-system-label",defaultMessage:"Use system settings"})),T.map(r=>e.createElement(L.eY,{value:r,key:r},s({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:s({id:r,defaultMessage:ne()(r)})}))))))))};Q.propTypes={allApplicationThemes:t().object,onChange:t().func,values:t().shape({preferedLanguage:t().string,currentTheme:t().string}),localeNames:t().object},Q.defaultProps={allApplicationThemes:{},onChange(){},values:{preferedLanguage:null,currentTheme:""},localeNames:{}};const re=Q,D=({errors:n,onChange:d,values:m})=>{const{formatMessage:i}=(0,j.A)();return e.createElement(h.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(y.s,{direction:"column",alignItems:"stretch",gap:4},e.createElement(U.o,{variant:"delta",as:"h2"},i({id:"global.profile",defaultMessage:"Profile"})),e.createElement(W.x,{gap:5},e.createElement(u.E,{s:12,col:6},e.createElement(l.ah,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:n.firstname,onChange:d,value:m.firstname,type:"text",name:"firstname",required:!0})),e.createElement(u.E,{s:12,col:6},e.createElement(l.ah,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:n.lastname,onChange:d,value:m.lastname,type:"text",name:"lastname"})),e.createElement(u.E,{s:12,col:6},e.createElement(l.ah,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:n.email,onChange:d,value:m.email,type:"email",name:"email",required:!0})),e.createElement(u.E,{s:12,col:6},e.createElement(l.ah,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:n.username,onChange:d,value:m.username,type:"text",name:"username"})))))};D.propTypes={errors:t().shape({firstname:t().string,lastname:t().string,username:t().string,email:t().string}),onChange:t().func,values:t().shape({firstname:t().string,lastname:t().string,username:t().string,email:t().string})},D.defaultProps={errors:{},onChange(){},values:{firstname:"",lastname:"",username:"",email:""}};const oe=D;var le=a(12083),ie=a(84241);const de=le.Ik().shape(ie.pK),me=()=>{const{changeLocale:n,localeNames:d}=(0,q.jc)(),{setUserDisplayName:m}=(0,l.Xe)(),i=(0,Y.useQueryClient)(),{formatMessage:s}=(0,j.A)(),{trackUsage:T}=(0,l.z1)(),r=(0,l.hN)(),{lockApp:x,unlockApp:C}=(0,l.MA)(),{notifyStatus:z}=(0,c.W)(),{currentTheme:w,themes:E,onChangeTheme:ce}=(0,_.f)(),{get:X,put:ue}=(0,l.ry)();(0,l.L4)();const{isLoading:ge,data:O}=(0,Y.useQuery)("user",async()=>{const{data:o}=await X("/admin/users/me");return o.data},{onSuccess(){z(s({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){r({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),{isLoading:pe,data:fe}=(0,Y.useQuery)(["providers","isSSOLocked"],async()=>{const{data:{data:o}}=await X("/admin/providers/isSSOLocked");return o},{enabled:window.strapi.isEE&&window.strapi.features.isEnabled("sso"),onError(){r({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})}}),he=ge||pe,J=(0,Y.useMutation)(async o=>{const{confirmPassword:g,currentTheme:p,...v}=o,{data:f}=await ue("/admin/users/me",v);return{...f.data,currentTheme:o.currentTheme}},{async onSuccess(o){await i.invalidateQueries("user");const{email:g,firstname:p,lastname:v,username:f,preferedLanguage:Te}=o;l.j2.setUserInfo({email:g,firstname:p,lastname:v,username:f,preferedLanguage:Te});const xe=o.username||(0,G.d)(o.firstname,o.lastname);m(xe),n(o.preferedLanguage),ce(o.currentTheme),T("didChangeMode",{newMode:o.currentTheme}),r({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},onSettled(){C()},refetchActive:!0}),{isLoading:we}=J,Ee=async(o,{setErrors:g})=>{x();const p=o.username||null;J.mutate({...o,username:p},{onError(v){const f=v?.response?.data;return f?.data?g(f.data):r({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})};if(he)return e.createElement(M.g,{"aria-busy":"true"},e.createElement(A.m,{title:s({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(N.Q,{title:s({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),e.createElement(b.s,null,e.createElement(l.Bl,null)));const ve=fe?.isSSOLocked??!1,{email:ye,firstname:Se,lastname:Me,username:Pe,preferedLanguage:Ae}=O,Le={email:ye,firstname:Se,lastname:Me,username:Pe,preferedLanguage:Ae,currentTheme:w};return e.createElement(M.g,{"aria-busy":we},e.createElement(A.m,{title:s({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(S.l1,{onSubmit:Ee,initialValues:Le,validateOnChange:!1,validationSchema:de,enableReinitialize:!0},({errors:o,values:g,handleChange:p,isSubmitting:v,dirty:f})=>e.createElement(l.lV,null,e.createElement(N.Q,{title:O.username||(0,G.d)(O.firstname,O.lastname),primaryAction:e.createElement($.$,{startIcon:e.createElement(P.A,null),loading:v,type:"submit",disabled:!f},s({id:"global.save",defaultMessage:"Save"}))}),e.createElement(h.a,{paddingBottom:10},e.createElement(b.s,null,e.createElement(y.s,{direction:"column",alignItems:"stretch",gap:6},e.createElement(oe,{errors:o,onChange:p,values:g}),!ve&&e.createElement(te,{errors:o,onChange:p,values:g}),e.createElement(re,{allApplicationThemes:E,onChange:p,values:g,localeNames:d})))))))}},84241:(k,I,a)=>{a.d(I,{Gd:()=>l,pK:()=>b});var e=a(12083),c=a(80403);const M={firstname:e.Yj().trim().required(c.iW.required),lastname:e.Yj(),email:e.Yj().email(c.iW.email).lowercase().required(c.iW.required),username:e.Yj().nullable(),password:e.Yj().min(8,c.iW.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Yj().min(8,c.iW.minLength).oneOf([e.KR("password"),null],"components.Input.error.password.noMatch").when("password",(P,S)=>P?S.required(c.iW.required):S)},b={...M,currentPassword:e.Yj().when(["password","confirmPassword"],(P,S,A)=>P||S?A.required(c.iW.required):A),preferedLanguage:e.Yj().nullable()},h={roles:e.YO().min(1,c.iW.required).required(c.iW.required)},l=e.Ik().shape({...M,isActive:e.lc(),...h})}}]);
