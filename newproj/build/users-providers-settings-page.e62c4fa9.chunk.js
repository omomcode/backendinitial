"use strict";(self.webpackChunknewproj=self.webpackChunknewproj||[]).push([[8750],{91784:(F,E,t)=>{t.r(E),t.d(E,{ProvidersPage:()=>de,default:()=>Le});var e=t(21272),o=t(42455),y=t(38413),M=t(55356),L=t(4198),x=t(35513),l=t(26127),p=t(90361),m=t(33363),P=t(30893),S=t(98765),R=t(25641),i=t(88353),a=t(80403),v=t(41909),u=t(39404),f=t.n(u),h=t(54894),O=t(74930),$=t(61485),k=t(99248),V=t(6239),ve=t(83997),fe=t(90151),pe=t(68074),he=t(67030),ae=t(85963),be=t(37679),Ee=t(60043),ye=t(61535),Me=t(33544),n=t.n(Me),Pe=t(7441),je=t(7537);const w=({description:c,disabled:D,intlLabel:U,error:C,name:T,onChange:Y,placeholder:d,providerToEditName:W,type:I,value:j})=>{const{formatMessage:b}=(0,h.A)(),z=T==="noName"?`${window.strapi.backendURL}/api/connect/${W}/callback`:j,A=b({id:U.id,defaultMessage:U.defaultMessage},{provider:W,...U.values}),B=c?b({id:c.id,defaultMessage:c.defaultMessage},{provider:W,...c.values}):"";if(I==="bool")return e.createElement(Pe.l,{"aria-label":T,checked:j,disabled:D,hint:B,label:A,name:T,offLabel:b({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:b({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:H=>{Y({target:{name:T,value:H.target.checked}})}});const q=d?b({id:d.id,defaultMessage:d.defaultMessage},{...d.values}):"",_=C?b({id:C,defaultMessage:C}):"";return e.createElement(je.k,{"aria-label":T,disabled:D,error:_,label:A,name:T,onChange:Y,placeholder:q,type:I,value:z})};w.defaultProps={description:null,disabled:!1,error:"",placeholder:null,value:""},w.propTypes={description:n().shape({id:n().string.isRequired,defaultMessage:n().string.isRequired,values:n().object}),disabled:n().bool,error:n().string,intlLabel:n().shape({id:n().string.isRequired,defaultMessage:n().string.isRequired,values:n().object}).isRequired,name:n().string.isRequired,onChange:n().func.isRequired,placeholder:n().shape({id:n().string.isRequired,defaultMessage:n().string.isRequired,values:n().object}),providerToEditName:n().string.isRequired,type:n().string.isRequired,value:n().oneOfType([n().bool,n().string])};const xe=w,G=({headerBreadcrumbs:c,initialData:D,isSubmiting:U,layout:C,isOpen:T,onSubmit:Y,onToggle:d,providerToEditName:W})=>{const{formatMessage:I}=(0,h.A)();return T?e.createElement($.k,{onClose:d,labelledBy:"title"},e.createElement(k.r,null,e.createElement(be.B,{label:c.join(", ")},c.map((j,b,z)=>e.createElement(Ee.m,{isCurrent:b===z.length-1,key:j},j)))),e.createElement(ye.l1,{onSubmit:j=>Y(j),initialValues:D,validationSchema:C.schema,validateOnChange:!1},({errors:j,handleChange:b,values:z})=>e.createElement(a.lV,null,e.createElement(V.c,null,e.createElement(ve.s,{direction:"column",alignItems:"stretch",gap:1},e.createElement(fe.x,{gap:5},C.form.map(A=>A.map(B=>e.createElement(pe.E,{key:B.name,col:B.size,xs:12},e.createElement(xe,{...B,error:j[B.name],onChange:b,value:z[B.name],providerToEditName:W}))))))),e.createElement(he.j,{startActions:e.createElement(ae.$,{variant:"tertiary",onClick:d,type:"button"},I({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(ae.$,{type:"submit",loading:U},I({id:"global.save",defaultMessage:"Save"}))})))):null};G.defaultProps={initialData:null,providerToEditName:null},G.propTypes={headerBreadcrumbs:n().arrayOf(n().string).isRequired,initialData:n().object,layout:n().shape({form:n().arrayOf(n().array),schema:n().object}).isRequired,isOpen:n().bool.isRequired,isSubmiting:n().bool.isRequired,onSubmit:n().func.isRequired,onToggle:n().func.isRequired,providerToEditName:n().string};const Te=G;var ne=t(69224),g=t(46215),s=t(12083);const se={id:(0,g.gT)("PopUpForm.Providers.redirectURL.front-end.label"),defaultMessage:"The redirect URL to your front-end app"},re={id:"http://www.client-app.com",defaultMessage:"http://www.client-app.com"},J={id:(0,g.gT)("PopUpForm.Providers.enabled.description"),defaultMessage:"If disabled, users won't be able to use this provider."},X={id:(0,g.gT)("PopUpForm.Providers.enabled.label"),defaultMessage:"Enable"},ie={id:(0,g.gT)("PopUpForm.Providers.key.label"),defaultMessage:"Client ID"},le={id:(0,g.gT)("PopUpForm.Providers.redirectURL.label"),defaultMessage:"The redirect URL to add in your {provider} application configurations"},N={id:(0,g.gT)("PopUpForm.Providers.key.placeholder"),defaultMessage:"TEXT"},oe={id:(0,g.gT)("PopUpForm.Providers.secret.label"),defaultMessage:"Client Secret"},Z={email:{form:[[{intlLabel:X,name:"enabled",type:"bool",description:J,size:6}]],schema:s.Ik().shape({enabled:s.lc().required(a.iW.required)})},providers:{form:[[{intlLabel:X,name:"enabled",type:"bool",description:J,size:6,validations:{required:!0}}],[{intlLabel:ie,name:"key",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:oe,name:"secret",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:se,placeholder:re,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:le,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:s.Ik().shape({enabled:s.lc().required(a.iW.required),key:s.Yj().when("enabled",{is:!0,then:s.Yj().required(a.iW.required),otherwise:s.Yj()}),secret:s.Yj().when("enabled",{is:!0,then:s.Yj().required(a.iW.required),otherwise:s.Yj()}),callback:s.Yj().when("enabled",{is:!0,then:s.Yj().required(a.iW.required),otherwise:s.Yj()})})},providersWithSubdomain:{form:[[{intlLabel:X,name:"enabled",type:"bool",description:J,size:6,validations:{required:!0}}],[{intlLabel:ie,name:"key",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:oe,name:"secret",type:"text",placeholder:N,size:12,validations:{required:!0}}],[{intlLabel:{id:(0,g.gT)({id:"PopUpForm.Providers.jwksurl.label"}),defaultMessage:"JWKS URL"},name:"jwksurl",type:"text",placeholder:N,size:12,validations:{required:!1}}],[{intlLabel:{id:(0,g.gT)("PopUpForm.Providers.subdomain.label"),defaultMessage:"Host URI (Subdomain)"},name:"subdomain",type:"text",placeholder:{id:(0,g.gT)("PopUpForm.Providers.subdomain.placeholder"),defaultMessage:"my.subdomain.com"},size:12,validations:{required:!0}}],[{intlLabel:se,placeholder:re,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:le,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:s.Ik().shape({enabled:s.lc().required(a.iW.required),key:s.Yj().when("enabled",{is:!0,then:s.Yj().required(a.iW.required),otherwise:s.Yj()}),secret:s.Yj().when("enabled",{is:!0,then:s.Yj().required(a.iW.required),otherwise:s.Yj()}),subdomain:s.Yj().when("enabled",{is:!0,then:s.Yj().required(a.iW.required),otherwise:s.Yj()}),callback:s.Yj().when("enabled",{is:!0,then:s.Yj().required(a.iW.required),otherwise:s.Yj()})})}},de=()=>{const{formatMessage:c,locale:D}=(0,h.A)(),U=(0,O.useQueryClient)(),{trackUsage:C}=(0,a.z1)(),[T,Y]=e.useState(!1),[d,W]=e.useState(null),I=(0,a.hN)(),{lockApp:j,unlockApp:b}=(0,a.MA)(),{get:z,put:A}=(0,a.ry)(),{formatAPIError:B}=(0,a.wq)(),q=(0,a.QM)(D,{sensitivity:"base"});(0,a.L4)();const{isLoading:_,allowedActions:{canUpdate:H}}=(0,a.ec)({update:ne.J.updateProviders}),{isLoading:Re,data:ee}=(0,O.useQuery)(["users-permissions","get-providers"],async()=>{const{data:r}=await z("/users-permissions/providers");return r},{initialData:{}}),ue=(0,O.useMutation)(r=>A("/users-permissions/providers",r),{async onSuccess(){await U.invalidateQueries(["users-permissions","providers"]),I({type:"success",message:{id:(0,g.gT)("notification.success.submit")}}),C("didEditAuthenticationProvider"),te(),b()},onError(r){I({type:"warning",message:B(r)}),b()},refetchActive:!1}),Q=Object.entries(ee).reduce((r,[K,Ie])=>{const{icon:ge,enabled:Se,subdomain:Ue}=Ie;return r.push({name:K,icon:ge==="envelope"?["fas","envelope"]:["fab",ge],enabled:Se,subdomain:Ue}),r},[]).sort((r,K)=>q.compare(r.name,K.name)),Ce=Re||_,ce=e.useMemo(()=>d?!!Q.find(K=>K.name===d)?.subdomain:!1,[Q,d]),Be=e.useMemo(()=>d==="email"?Z.email:ce?Z.providersWithSubdomain:Z.providers,[d,ce]),te=()=>{Y(r=>!r)},me=r=>{H&&(W(r.name),te())},Oe=async r=>{j(),C("willEditAuthenticationProvider"),ue.mutate({providers:{...ee,[d]:r}})};return e.createElement(o.P,null,e.createElement(a.x7,{name:c({id:(0,g.gT)("HeaderNav.link.providers"),defaultMessage:"Providers"})}),e.createElement(y.g,null,e.createElement(M.Q,{title:c({id:(0,g.gT)("HeaderNav.link.providers"),defaultMessage:"Providers"})}),Ce?e.createElement(a.Bl,null):e.createElement(L.s,null,e.createElement(x.X,{colCount:3,rowCount:Q.length+1},e.createElement(l.d,null,e.createElement(p.Tr,null,e.createElement(m.Th,null,e.createElement(P.o,{variant:"sigma",textColor:"neutral600"},c({id:"global.name",defaultMessage:"Name"}))),e.createElement(m.Th,null,e.createElement(P.o,{variant:"sigma",textColor:"neutral600"},c({id:(0,g.gT)("Providers.status"),defaultMessage:"Status"}))),e.createElement(m.Th,null,e.createElement(P.o,{variant:"sigma"},e.createElement(S.s,null,c({id:"global.settings",defaultMessage:"Settings"})))))),e.createElement(R.N,null,Q.map(r=>e.createElement(p.Tr,{key:r.name,...(0,a.qM)({fn:()=>me(r),condition:H})},e.createElement(m.Td,{width:"45%"},e.createElement(P.o,{fontWeight:"semiBold",textColor:"neutral800"},r.name)),e.createElement(m.Td,{width:"65%"},e.createElement(P.o,{textColor:r.enabled?"success600":"danger600","data-testid":`enable-${r.name}`},r.enabled?c({id:"global.enabled",defaultMessage:"Enabled"}):c({id:"global.disabled",defaultMessage:"Disabled"}))),e.createElement(m.Td,{...a.dG},H&&e.createElement(i.K,{onClick:()=>me(r),noBorder:!0,icon:e.createElement(v.A,null),label:"Edit"})))))))),e.createElement(Te,{initialData:ee[d],isOpen:T,isSubmiting:ue.isLoading,layout:Be,headerBreadcrumbs:[c({id:(0,g.gT)("PopUpForm.header.edit.providers"),defaultMessage:"Edit Provider"}),f()(d)],onToggle:te,onSubmit:Oe,providerToEditName:d}))},Le=()=>e.createElement(a.kz,{permissions:ne.J.readProviders},e.createElement(de,null))},46215:(F,E,t)=>{t.d(E,{mr:()=>M,gT:()=>L.A});var e=t(77965),o=t.n(e);const M=x=>Object.keys(x).reduce((l,p)=>{const m=x[p].controllers,P=Object.keys(m).reduce((S,R)=>(o()(m[R])||(S[R]=m[R]),S),{});return o()(P)||(l[p]={controllers:P}),l},{});var L=t(34075)},4198:(F,E,t)=>{t.d(E,{s:()=>y});var e=t(92132),o=t(94061);const y=({children:M})=>(0,e.jsx)(o.a,{paddingLeft:10,paddingRight:10,children:M})},55356:(F,E,t)=>{t.d(E,{$:()=>R,Q:()=>P});var e=t(92132),o=t(21272),y=t(79793);const M=i=>{const a=(0,o.useRef)(null),[v,u]=(0,o.useState)(!0),f=([h])=>{u(h.isIntersecting)};return(0,o.useEffect)(()=>{const h=a.current,O=new IntersectionObserver(f,i);return h&&O.observe(a.current),()=>{h&&O.disconnect()}},[a,i]),[a,v]};var L=t(23169);const x=(i,a)=>{const v=(0,L.c)(a);(0,o.useLayoutEffect)(()=>{const u=new ResizeObserver(v);return Array.isArray(i)?i.forEach(f=>{f.current&&u.observe(f.current)}):i.current&&u.observe(i.current),()=>{u.disconnect()}},[i,v])};var l=t(94061),p=t(83997),m=t(30893);const P=i=>{const a=(0,o.useRef)(null),[v,u]=(0,o.useState)(null),[f,h]=M({root:null,rootMargin:"0px",threshold:0});return x(f,()=>{f.current&&u(f.current.getBoundingClientRect())}),(0,o.useEffect)(()=>{a.current&&u(a.current.getBoundingClientRect())},[a]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{height:v?.height},ref:f,children:h&&(0,e.jsx)(R,{ref:a,...i})}),!h&&(0,e.jsx)(R,{...i,sticky:!0,width:v?.width})]})};P.displayName="HeaderLayout";const S=(0,y.Ay)(l.a)`
  width: ${({width:i})=>i?`${i/16}rem`:void 0};
  z-index: ${({theme:i})=>i.zIndices[1]};
`,R=o.forwardRef(({navigationAction:i,primaryAction:a,secondaryAction:v,subtitle:u,title:f,sticky:h,width:O,...$},k)=>{const V=typeof u=="string";return h?(0,e.jsx)(S,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:O,"data-strapi-header-sticky":!0,children:(0,e.jsxs)(p.s,{justifyContent:"space-between",children:[(0,e.jsxs)(p.s,{children:[i&&(0,e.jsx)(l.a,{paddingRight:3,children:i}),(0,e.jsxs)(l.a,{children:[(0,e.jsx)(m.o,{variant:"beta",as:"h1",...$,children:f}),V?(0,e.jsx)(m.o,{variant:"pi",textColor:"neutral600",children:u}):u]}),v?(0,e.jsx)(l.a,{paddingLeft:4,children:v}):null]}),(0,e.jsx)(p.s,{children:a?(0,e.jsx)(l.a,{paddingLeft:2,children:a}):void 0})]})}):(0,e.jsxs)(l.a,{ref:k,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:i?6:8,background:"neutral100","data-strapi-header":!0,children:[i?(0,e.jsx)(l.a,{paddingBottom:2,children:i}):null,(0,e.jsxs)(p.s,{justifyContent:"space-between",children:[(0,e.jsxs)(p.s,{minWidth:0,children:[(0,e.jsx)(m.o,{as:"h1",variant:"alpha",...$,children:f}),v?(0,e.jsx)(l.a,{paddingLeft:4,children:v}):null]}),a]}),V?(0,e.jsx)(m.o,{variant:"epsilon",textColor:"neutral600",as:"p",children:u}):u]})})},42455:(F,E,t)=>{t.d(E,{P:()=>x});var e=t(92132),o=t(79793),y=t(94061);const M=(0,o.Ay)(y.a)`
  display: grid;
  grid-template-columns: ${({hasSideNav:l})=>l?"auto 1fr":"1fr"};
`,L=(0,o.Ay)(y.a)`
  overflow-x: hidden;
`,x=({sideNav:l,children:p})=>(0,e.jsxs)(M,{hasSideNav:Boolean(l),children:[l,(0,e.jsx)(L,{paddingBottom:10,children:p})]})},38413:(F,E,t)=>{t.d(E,{g:()=>L});var e=t(92132),o=t(79793),y=t(94061);const M=(0,o.Ay)(y.a)`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,L=({labelledBy:x="main-content-title",...l})=>(0,e.jsx)(M,{"aria-labelledby":x,as:"main",id:"main-content",tabIndex:-1,...l})}}]);
