"use strict";(self.webpackChunknewproj=self.webpackChunknewproj||[]).push([[3064],{42761:(A,T,t)=>{t.r(T),t.d(T,{default:()=>ie});var e=t(21272),o=t(11273),j=t(38413),y=t(55356),L=t(4198),a=t(80403),l=t(54894),E=t(74930),v=t(69224),s=t(46215),B=t(61485),x=t(99248),n=t(6239),r=t(90151),i=t(68074),m=t(5287),c=t(67030),f=t(85963),I=t(37679),O=t(60043),U=t(61535),F=t(33544),u=t.n(F),R=t(12083);const w=R.Ik().shape({options:R.Ik().shape({from:R.Ik().shape({name:R.Yj().required(a.iW.required),email:R.Yj().email(a.iW.email).required(a.iW.required)}).required(),response_email:R.Yj().email(a.iW.email),object:R.Yj().required(a.iW.required),message:R.Yj().required(a.iW.required)}).required(a.iW.required)}),$=({template:d,onToggle:M,onSubmit:p})=>{const{formatMessage:h}=(0,l.A)();return e.createElement(B.k,{onClose:M,labelledBy:`${h({id:(0,s.gT)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${h({id:(0,s.gT)(d.display),defaultMessage:d.display})}`},e.createElement(x.r,null,e.createElement(I.B,{label:`${h({id:(0,s.gT)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${h({id:(0,s.gT)(d.display),defaultMessage:d.display})}`},e.createElement(O.m,null,h({id:(0,s.gT)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})),e.createElement(O.m,{isCurrent:!0},h({id:(0,s.gT)(d.display),defaultMessage:d.display})))),e.createElement(U.l1,{onSubmit:p,initialValues:d,validateOnChange:!1,validationSchema:w,enableReinitialize:!0},({errors:b,values:P,handleChange:S,isSubmitting:z})=>e.createElement(a.lV,null,e.createElement(n.c,null,e.createElement(r.x,{gap:5},e.createElement(i.E,{col:6,s:12},e.createElement(a.ah,{intlLabel:{id:(0,s.gT)("PopUpForm.Email.options.from.name.label"),defaultMessage:"Shipper name"},name:"options.from.name",onChange:S,value:P.options.from.name,error:b?.options?.from?.name,type:"text"})),e.createElement(i.E,{col:6,s:12},e.createElement(a.ah,{intlLabel:{id:(0,s.gT)("PopUpForm.Email.options.from.email.label"),defaultMessage:"Shipper email"},name:"options.from.email",onChange:S,value:P.options.from.email,error:b?.options?.from?.email,type:"text"})),e.createElement(i.E,{col:6,s:12},e.createElement(a.ah,{intlLabel:{id:(0,s.gT)("PopUpForm.Email.options.response_email.label"),defaultMessage:"Response email"},name:"options.response_email",onChange:S,value:P.options.response_email,error:b?.options?.response_email,type:"text"})),e.createElement(i.E,{col:6,s:12},e.createElement(a.ah,{intlLabel:{id:(0,s.gT)("PopUpForm.Email.options.object.label"),defaultMessage:"Subject"},name:"options.object",onChange:S,value:P.options.object,error:b?.options?.object,type:"text"})),e.createElement(i.E,{col:12,s:12},e.createElement(m.T,{label:h({id:(0,s.gT)("PopUpForm.Email.options.message.label"),defaultMessage:"Message"}),id:"options.message",onChange:S,value:P.options.message,error:b?.options?.message&&h({id:b.options.message,defaultMessage:b.options.message})})))),e.createElement(c.j,{startActions:e.createElement(f.$,{onClick:M,variant:"tertiary"},"Cancel"),endActions:e.createElement(f.$,{loading:z,type:"submit"},"Finish")}))))};$.propTypes={template:u().shape({display:u().string,icon:u().string,options:u().shape({from:u().shape({name:u().string,email:u().string}),message:u().string,object:u().string,response_email:u().string})}).isRequired,onSubmit:u().func.isRequired,onToggle:u().func.isRequired};const k=$;var q=t(35513),_=t(26127),W=t(90361),C=t(33363),N=t(98765),H=t(30893),ee=t(25641),K=t(58805),Q=t(88353),te=t(70603),V=t(41909),ae=t(54514);const Y=({canUpdate:d,onEditClick:M})=>{const{formatMessage:p}=(0,l.A)();return e.createElement(q.X,{colCount:3,rowCount:3},e.createElement(_.d,null,e.createElement(W.Tr,null,e.createElement(C.Th,{width:"1%"},e.createElement(N.s,null,p({id:(0,s.gT)("Email.template.table.icon.label"),defaultMessage:"icon"}))),e.createElement(C.Th,null,e.createElement(H.o,{variant:"sigma",textColor:"neutral600"},p({id:(0,s.gT)("Email.template.table.name.label"),defaultMessage:"name"}))),e.createElement(C.Th,{width:"1%"},e.createElement(N.s,null,p({id:(0,s.gT)("Email.template.table.action.label"),defaultMessage:"action"}))))),e.createElement(ee.N,null,e.createElement(W.Tr,{...(0,a.qM)({fn:()=>M("reset_password")})},e.createElement(C.Td,null,e.createElement(K.I,null,e.createElement(te.A,{"aria-label":p({id:"global.reset-password",defaultMessage:"Reset password"})}))),e.createElement(C.Td,null,e.createElement(H.o,null,p({id:"global.reset-password",defaultMessage:"Reset password"}))),e.createElement(C.Td,{...a.dG},e.createElement(Q.K,{onClick:()=>M("reset_password"),label:p({id:(0,s.gT)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:d&&e.createElement(V.A,null)}))),e.createElement(W.Tr,{...(0,a.qM)({fn:()=>M("email_confirmation")})},e.createElement(C.Td,null,e.createElement(K.I,null,e.createElement(ae.A,{"aria-label":p({id:(0,s.gT)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"})}))),e.createElement(C.Td,null,e.createElement(H.o,null,p({id:(0,s.gT)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"}))),e.createElement(C.Td,{...a.dG},e.createElement(Q.K,{onClick:()=>M("email_confirmation"),label:p({id:(0,s.gT)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:d&&e.createElement(V.A,null)})))))};Y.propTypes={canUpdate:u().bool.isRequired,onEditClick:u().func.isRequired};const se=Y,ne=()=>e.createElement(a.kz,{permissions:v.J.readEmailTemplates},e.createElement(le,null)),le=()=>{const{formatMessage:d}=(0,l.A)(),{trackUsage:M}=(0,a.z1)(),{notifyStatus:p}=(0,o.W)(),h=(0,a.hN)(),{lockApp:b,unlockApp:P}=(0,a.MA)(),S=(0,E.useQueryClient)(),{get:z,put:oe}=(0,a.ry)(),{formatAPIError:G}=(0,a.wq)();(0,a.L4)();const[re,me]=e.useState(!1),[J,de]=e.useState(null),{isLoading:ce,allowedActions:{canUpdate:ue}}=(0,a.ec)({update:v.J.updateEmailTemplates}),{isLoading:pe,data:X}=(0,E.useQuery)(["users-permissions","email-templates"],async()=>{const{data:g}=await z("/users-permissions/email-templates");return g},{onSuccess(){p(d({id:(0,s.gT)("Email.template.data.loaded"),defaultMessage:"Email templates has been loaded"}))},onError(g){h({type:"warning",message:G(g)})}}),ge=ce||pe,D=()=>{me(g=>!g)},Ee=g=>{de(g),D()},Z=(0,E.useMutation)(g=>oe("/users-permissions/email-templates",{"email-templates":g}),{async onSuccess(){await S.invalidateQueries(["users-permissions","email-templates"]),h({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}}),M("didEditEmailTemplates"),P(),D()},onError(g){h({type:"warning",message:G(g)}),P()},refetchActive:!0}),fe=g=>{b(),M("willEditEmailTemplates");const he={...X,[J]:g};Z.mutate(he)};return ge?e.createElement(j.g,{"aria-busy":"true"},e.createElement(a.x7,{name:d({id:(0,s.gT)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(y.Q,{title:d({id:(0,s.gT)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(L.s,null,e.createElement(a.Bl,null))):e.createElement(j.g,{"aria-busy":Z.isLoading},e.createElement(a.x7,{name:d({id:(0,s.gT)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(y.Q,{title:d({id:(0,s.gT)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(L.s,null,e.createElement(se,{onEditClick:Ee,canUpdate:ue}),re&&e.createElement(k,{template:X[J],onToggle:D,onSubmit:fe})))},ie=ne},46215:(A,T,t)=>{t.d(T,{mr:()=>y,gT:()=>L.A});var e=t(77965),o=t.n(e);const y=a=>Object.keys(a).reduce((l,E)=>{const v=a[E].controllers,s=Object.keys(v).reduce((B,x)=>(o()(v[x])||(B[x]=v[x]),B),{});return o()(s)||(l[E]={controllers:s}),l},{});var L=t(34075)},4198:(A,T,t)=>{t.d(T,{s:()=>j});var e=t(92132),o=t(94061);const j=({children:y})=>(0,e.jsx)(o.a,{paddingLeft:10,paddingRight:10,children:y})},55356:(A,T,t)=>{t.d(T,{$:()=>x,Q:()=>s});var e=t(92132),o=t(21272),j=t(79793);const y=n=>{const r=(0,o.useRef)(null),[i,m]=(0,o.useState)(!0),c=([f])=>{m(f.isIntersecting)};return(0,o.useEffect)(()=>{const f=r.current,I=new IntersectionObserver(c,n);return f&&I.observe(r.current),()=>{f&&I.disconnect()}},[r,n]),[r,i]};var L=t(23169);const a=(n,r)=>{const i=(0,L.c)(r);(0,o.useLayoutEffect)(()=>{const m=new ResizeObserver(i);return Array.isArray(n)?n.forEach(c=>{c.current&&m.observe(c.current)}):n.current&&m.observe(n.current),()=>{m.disconnect()}},[n,i])};var l=t(94061),E=t(83997),v=t(30893);const s=n=>{const r=(0,o.useRef)(null),[i,m]=(0,o.useState)(null),[c,f]=y({root:null,rootMargin:"0px",threshold:0});return a(c,()=>{c.current&&m(c.current.getBoundingClientRect())}),(0,o.useEffect)(()=>{r.current&&m(r.current.getBoundingClientRect())},[r]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{height:i?.height},ref:c,children:f&&(0,e.jsx)(x,{ref:r,...n})}),!f&&(0,e.jsx)(x,{...n,sticky:!0,width:i?.width})]})};s.displayName="HeaderLayout";const B=(0,j.Ay)(l.a)`
  width: ${({width:n})=>n?`${n/16}rem`:void 0};
  z-index: ${({theme:n})=>n.zIndices[1]};
`,x=o.forwardRef(({navigationAction:n,primaryAction:r,secondaryAction:i,subtitle:m,title:c,sticky:f,width:I,...O},U)=>{const F=typeof m=="string";return f?(0,e.jsx)(B,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:I,"data-strapi-header-sticky":!0,children:(0,e.jsxs)(E.s,{justifyContent:"space-between",children:[(0,e.jsxs)(E.s,{children:[n&&(0,e.jsx)(l.a,{paddingRight:3,children:n}),(0,e.jsxs)(l.a,{children:[(0,e.jsx)(v.o,{variant:"beta",as:"h1",...O,children:c}),F?(0,e.jsx)(v.o,{variant:"pi",textColor:"neutral600",children:m}):m]}),i?(0,e.jsx)(l.a,{paddingLeft:4,children:i}):null]}),(0,e.jsx)(E.s,{children:r?(0,e.jsx)(l.a,{paddingLeft:2,children:r}):void 0})]})}):(0,e.jsxs)(l.a,{ref:U,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:n?6:8,background:"neutral100","data-strapi-header":!0,children:[n?(0,e.jsx)(l.a,{paddingBottom:2,children:n}):null,(0,e.jsxs)(E.s,{justifyContent:"space-between",children:[(0,e.jsxs)(E.s,{minWidth:0,children:[(0,e.jsx)(v.o,{as:"h1",variant:"alpha",...O,children:c}),i?(0,e.jsx)(l.a,{paddingLeft:4,children:i}):null]}),r]}),F?(0,e.jsx)(v.o,{variant:"epsilon",textColor:"neutral600",as:"p",children:m}):m]})})},38413:(A,T,t)=>{t.d(T,{g:()=>L});var e=t(92132),o=t(79793),j=t(94061);const y=(0,o.Ay)(j.a)`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,L=({labelledBy:a="main-content-title",...l})=>(0,e.jsx)(y,{"aria-labelledby":a,as:"main",id:"main-content",tabIndex:-1,...l})}}]);
